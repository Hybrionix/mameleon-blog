---
// filepath: src/pages/blog/[slug].astro
import Layout from '../../../layouts/MainLayout.astro';
import { getCollection, getEntryBySlug } from 'astro:content';

export async function getStaticPaths() {
  // Only English blog posts: files ending with .en.md
  const allPosts = await getCollection('blog');
  const enPosts = allPosts.filter(post => post.slug.endsWith('.en'));
  return enPosts.map(post => ({
    params: { slug: post.slug.replace(/\.en$/, '') }
  }));
}

const { slug } = Astro.params;
const post = await getEntryBySlug('blog', `${slug}.en`);

if (!post) {
  throw new Error(`English blog post not found: ${slug}`);
}
---
<Layout title={post.data.title} description={post.data.description} lang="en">
  <article>
    <h1>{post.data.title}</h1>
    <img src={post.data.heroImage} alt="" />
    <p>{post.data.pubDate}</p>
    <div innerHTML={post.body} />
  </article>
</Layout>